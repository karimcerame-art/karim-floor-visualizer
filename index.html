<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Floor Visualizer</title>

<style>
body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,sans-serif;
    background:#f2f2f2;
}

/* APP CONTAINER */
.app{
    max-width:430px;
    margin:auto;
    min-height:100vh;
    background:#fff;
}

/* HEADER */
.header{
    background:#111;
    color:#fff;
    padding:14px;
    text-align:center;
    font-size:18px;
    font-weight:600;
}

/* MAIN PREVIEW */
.preview{
    position:relative;
    width:100%;
    height:330px;
    background:#e6e6e6;
    display:flex;
    align-items:center;
    justify-content:center;
}

.preview img,
.preview canvas{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
}

.preview span{
    color:#777;
    font-size:14px;
}

/* BOTTOM AREA */
.bottom{
    display:flex;
    gap:10px;
    padding:12px;
}

/* DROP BOX */
.box{
    flex:1;
    height:120px;
    border:2px dashed #ccc;
    border-radius:10px;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    font-size:13px;
    color:#666;
    position:relative;
    overflow:hidden;
}

.box img{
    width:100%;
    height:100%;
    object-fit:cover;
    position:absolute;
    inset:0;
}

.box input{
    position:absolute;
    inset:0;
    opacity:0;
    cursor:pointer;
}

/* BUTTON */
button{
    width:calc(100% - 24px);
    margin:12px;
    padding:14px;
    background:#111;
    color:#fff;
    border:none;
    border-radius:14px;
    font-size:18px;
}
</style>
</head>

<body>

<div class="app">

    <div class="header">Floor Visualizer</div>

    <!-- MAIN RESULT -->
    <div class="preview">
        <span id="previewText">Preview</span>
        <img id="roomImg">
        <canvas id="canvas"></canvas>
    </div>

    <!-- UPLOADS -->
    <div class="bottom">

        <!-- ROOM -->
        <div class="box">
            <span>Room<br>Click to Upload</span>
            <img id="roomThumb">
            <input type="file" accept="image/*" id="roomInput">
        </div>

        <!-- LAMINATE -->
        <div class="box">
            <span>Laminate<br>Click to Upload</span>
            <img id="laminateThumb">
            <input type="file" accept="image/*" id="laminateInput">
        </div>

    </div>

    <button onclick="applyFloor()">Apply Floor</button>

</div>

<script>
const roomInput = document.getElementById("roomInput");
const laminateInput = document.getElementById("laminateInput");

const roomImg = document.getElementById("roomImg");
const roomThumb = document.getElementById("roomThumb");
const laminateThumb = document.getElementById("laminateThumb");

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let laminateImage = null;

/* ROOM UPLOAD */
roomInput.onchange = e => {
    const file = e.target.files[0];
    if(!file) return;
    const url = URL.createObjectURL(file);
    roomImg.src = url;
    roomThumb.src = url;
    document.getElementById("previewText").style.display="none";
};

/* LAMINATE UPLOAD */
laminateInput.onchange = e => {
    const file = e.target.files[0];
    if(!file) return;
    laminateImage = new Image();
    laminateImage.src = URL.createObjectURL(file);
    laminateThumb.src = laminateImage.src;
};

/* APPLY FLOOR */
function applyFloor(){
    if(!roomImg.src || !laminateImage){
        alert("Upload room and laminate");
        return;
    }

    canvas.width = roomImg.clientWidth;
    canvas.height = roomImg.clientHeight;

    laminateImage.onload = () => {
        const pattern = ctx.createPattern(laminateImage,"repeat");
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = pattern;
        ctx.globalAlpha = 0.85;

        /* FLOOR AREA (BOTTOM PART) */
        ctx.fillRect(
            0,
            canvas.height*0.55,
            canvas.width,
            canvas.height*0.45
        );

        ctx.globalAlpha = 1;
    };
}
</script>

</body>
</html>
